<div class="layui-container" style="margin-top:10px;">
    <div class="layui-row">
        {include file="user/rightmenu" /}
        <div class="layui-col-lg9">

            <table class="layui-hide" id="deviceList" lay-filter="deviceList"></table>
            <script type="text/html" id="barTool">
                <a class="layui-btn layui-btn-xs" lay-event="view">查看</a>
                <a class="layui-btn layui-btn-xs" lay-event="del">删除</a>
            </script>
        </div>
    </div>
</div>
<script>

    layui.use('table', function () {
        var table = layui.table;
        table.render({
            elem: '#deviceList'
            , url: '/api/device/deviceList'
            , toolbar: true
            , title: '设备列表'
            , cols: [[
                {field: 'device_id', title: '设备ID', width: 80, fixed: 'left'}
                , {field: 'device_name', title: '设备名', width: 120}
                , {field: 'desc', title: '简介', width: 150}
                , {field: 'status', title: '状态', width: 80}
                , {field: 'location', title: '设备部署地址', width: 120}
                , {field: 'create_at', title: '创建时间', width: 120}
                , {fixed: 'right', title: '操作', toolbar: '#barTool', width: 150}
            ]]
            , page: true
            , response: {
                statusCode: 1 //重新规定成功的状态码为 1
            }, parseData: function (res) { //将原始数据解析成 table 组件所规定的数据
                return {
                    "code": res.code, //解析接口状态
                    "msg": res.message, //解析提示文本
                    "count": res.data.total, //解析数据长度
                    "data": res.data.rows //解析数据列表
                };
            }
        });
        //监听行工具事件
        table.on('tool(deviceList)', function (obj) {
            var data = obj.data;
            if (obj.event === 'view') {
                location.href = '/portal/cloud/deviceDetail?device='+obj.data.device_id;
            }
            if (obj.event === 'del') {
                layer.confirm('确定删除吗？', function (index) {
                    //layer.ajax({url:'',});
                    console.log(obj.data);
                });
            }
        });
    });
</script>